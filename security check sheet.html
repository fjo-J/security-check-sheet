<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>セキュリティチェックシート AIナレッジベース & ロードマップ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;700&display=swap');
        body { font-family: 'Noto Sans JP', sans-serif; }
        .tab-btn.active { border-color: #3b82f6; background-color: #3b82f6; color: white; }
        .table-container { width: 100%; overflow-x: auto; }
        table { width: 100%; min-width: 1200px; }
        th, td { padding: 10px; border: 1px solid #e5e7eb; vertical-align: top; white-space: normal; word-wrap: break-word; }
        th { background-color: #f3f4f6; font-weight: 700; position: sticky; top: 0; z-index: 1; cursor: pointer; }
        .search-box { position: sticky; top: 0; background: white; z-index: 10; padding-bottom: 1rem; }
    </style>
</head>
<body class="bg-gray-100 p-4 sm:p-6 lg:p-8">

    <div id="app" class="max-w-7xl mx-auto bg-white rounded-lg shadow-lg">
        <header class="p-4 border-b border-gray-200 flex justify-between items-center">
            <h1 class="text-2xl font-bold text-gray-800">セキュリティチェックシート ナレッジ＆ロードマップ</h1>
        </header>

        <div class="px-4 pt-4 border-b border-gray-200">
            <nav class="flex flex-wrap space-x-2" id="tabs">
                <button data-tab="search" class="tab-btn active px-4 py-2 text-sm font-medium border-b-2 border-transparent rounded-t-md">① 検索＆回答</button>
                <button data-tab="knowledge" class="tab-btn px-4 py-2 text-sm font-medium border-b-2 border-transparent rounded-t-md">② ナレッジベース</button>
                <button data-tab="roadmap" class="tab-btn px-4 py-2 text-sm font-medium border-b-2 border-transparent rounded-t-md">③ ロードマップ</button>
                <button data-tab="master" class="tab-btn px-4 py-2 text-sm font-medium border-b-2 border-transparent rounded-t-md">④ カテゴリマスタ</button>
                <button data-tab="manual" class="tab-btn px-4 py-2 text-sm font-medium border-b-2 border-transparent rounded-t-md">⑤ 使い方</button>
            </nav>
        </div>

        <main class="p-4 sm:p-6">
            <div id="search-content" class="tab-content"></div>
            <div id="knowledge-content" class="tab-content hidden"></div>
            <div id="roadmap-content" class="tab-content hidden"></div>
            <div id="master-content" class="tab-content hidden"></div>
            <div id="manual-content" class="tab-content hidden"></div>
        </main>
    </div>

<script type="module">
    // --- Data Section ---
    let knowledgeBaseData = [
        { "id": "SEC-0001", "daiCategory": "組織的セキュリティ", "chuCategory": "情報セキュリティ認証", "question": "ISMS (ISO/IEC 27001) など、第三者による情報セキュリティ認証を取得していますか？", "keywords": "ISMS,ISO27001,認証,Pマーク,プライバシーマーク", "answer": "はい。当社は情報セキュリティマネジメントシステム（ISMS）の国際規格である「ISO/IEC 27001」の認証を取得しております。", "supplement": "認証範囲や取得日などの詳細情報が必要な場合は、別途お問い合わせください。", "department": "情報システム部", "updated": "2025/08/27" },
        { "id": "SEC-0002", "daiCategory": "組織的セキュリティ", "chuCategory": "インシデント管理", "question": "情報漏洩やサービス停止など、セキュリティインシデント発生時の対処方法は確立されていますか？", "keywords": "インシデント,障害,漏洩,サービス停止,BCP", "answer": "はい。情報セキュリティインシデント対応規程を定め、インシデントの検知、報告、分析、復旧、再発防止策までの一連のプロセスを定義しています。重大なインシデント発生時には、経営層を含むインシデントレスポンスチームを招集し、迅速に対応します。", "supplement": "インシデント対応フロー図を別途ご提示可能です。", "department": "情報システム部", "updated": "2025/08/27" },
        { "id": "SEC-0003", "daiCategory": "技術的セキュリティ", "chuCategory": "脆弱性管理", "question": "セキュリティ専門部門が最新の脆弱性情報を収集し、本サービスに与える影響を確認し、定められたルールに従い対処を実施されていますか？", "keywords": "脆弱性,パッチ,アップデート,CVE", "answer": "はい。セキュリティ専門チームが複数の情報源から常に最新の脆弱性情報を収集しています。検知した脆弱性については、直ちにリスク評価を行い、本サービスへの影響度に応じて、計画に基づき修正パッチの適用などの対策を実施しています。", "supplement": "利用している脆弱性情報源や、リスク評価基準については、個別にお問い合わせください。", "department": "開発部", "updated": "2025/08/28" },
        { "id": "SEC-0004", "daiCategory": "技術的セキュリティ", "chuCategory": "脆弱性管理", "question": "定期的、さらに必要に応じて適宜に専門の脆弱性診断ツールを用いて、OSやミドルウェア等の検査を実施していますか？", "keywords": "脆弱性診断,スキャン,OS,ミドルウェア", "answer": "はい。システム全体に対して定期的な脆弱性スキャンを実施しています。また、システムの構成に大きな変更があった場合や、重大な脆弱性が公表された場合には、必要に応じて臨時の診断も実施しています。", "supplement": "", "department": "開発部", "updated": "2025/08/28" },
        { "id": "SEC-0005", "daiCategory": "技術的セキュリティ", "chuCategory": "不正アクセス対策", "question": "不正なアクティビティを阻止するためのIDS/IPSなどの仕組みを導入していますか？", "keywords": "IDS,IPS,不正侵入検知,不正侵入防止", "answer": "はい。サービスを提供するネットワークの境界にIDS/IPS（不正侵入検知・防御システム）を導入しており、不正な通信や攻撃の兆候を24時間365日体制で監視・ブロックしています。", "supplement": "", "department": "情報システム部", "updated": "2025/08/28" },
        { "id": "SEC-0006", "daiCategory": "技術的セキュリティ", "chuCategory": "アクセス制御", "question": "データへのアクセスについてアクセス権限が管理されているか / 誰もがアクセスできる状態になっていないか", "keywords": "アクセス権,権限管理,認可", "answer": "はい。データへのアクセスは、業務上必要な担当者のみに限定する「最小権限の原則」に基づき、厳格に管理されています。全てのアクセスは役割ベースのアクセスコントロール（RBAC）によって制御されています。", "supplement": "", "department": "情報システム部", "updated": "2025/08/28" },
        { "id": "SEC-0007", "daiCategory": "技術的セキュリティ", "chuCategory": "ログ管理", "question": "データへのアクセスについてアクセスログや操作ログが取得されているか", "keywords": "ログ,監査ログ,操作履歴", "answer": "はい。誰が、いつ、どのデータにアクセスし、どのような操作を行ったか、詳細なアクセスログ及び操作ログをすべて記録しています。これらのログは改ざん不可能な状態で安全に保管され、定期的にレビューされています。", "supplement": "ログの保管期間は原則として1年以上です。", "department": "情報システム部", "updated": "2025/08/28" },
        { "id": "SEC-0008", "daiCategory": "技術的セキュリティ", "chuCategory": "通信の保護", "question": "通信中のデータは保護されているか", "keywords": "暗号化,TLS,SSL,HTTPS", "answer": "はい。利用者と当社サービス間のすべての通信は、TLS 1.2以上の強力な暗号化技術を用いて保護されています。", "supplement": "", "department": "開発部", "updated": "2025/08/28" },
        { "id": "SEC-0009", "daiCategory": "技術的セキュリティ", "chuCategory": "マルウェア対策", "question": "マルウェア対策は行っているか", "keywords": "ウイルス対策,アンチウイルス,マルウェア", "answer": "はい。サービスを提供する全てのサーバーに商用のアンチマルウェアソフトを導入しており、定義ファイルは常に最新の状態に保たれています。また、定期的なシステムスキャンも実施しています。", "supplement": "", "department": "情報システム部", "updated": "2025/08/28" }
    ];
    let roadmapData = [
        { "id": "RM-0001", "question": "多要素認証は導入されていますか？", "current_state": "現在はID/パスワード認証のみ", "status": "未対応", "priority": "高", "department": "開発部", "target_date": "2025-12-31", "completion_date": "", "certification": "", "notes": "次期バージョンで実装を検討" },
        { "id": "RM-0002", "question": "SOC2 Type2レポートは取得していますか？", "current_state": "未取得", "status": "未対応", "priority": "中", "department": "情報システム部", "target_date": "2026-03-31", "completion_date": "", "certification": "SOC2 Type2", "notes": "監査法人と協議開始予定" },
        { "id": "RM-0003", "question": "責任分界点やネットワーク構成、システム構成が図示されている、簡単なシステム構成図の提出は可能か。", "current_state": "個別案件ごとに作成・提出しているが、汎用的な資料は未整備。", "status": "未対応", "priority": "中", "department": "営業企画部", "target_date": "2026-01-31", "completion_date": "", "certification": "", "notes": "標準的な構成図とカスタマイズ範囲を示す資料を作成する。" },
        { "id": "RM-0004", "question": "脆弱性対策に関するホワイトペーパーの提示は可能か。", "current_state": "ホワイトペーパーは未作成。", "status": "未対応", "priority": "低", "department": "マーケティング部", "target_date": "2026-06-30", "completion_date": "", "certification": "", "notes": "当社のセキュリティへの取り組みをまとめた資料を作成し、Webサイトで公開することを検討。" },
        { "id": "RM-0005", "question": "データはどこで保持されているか", "current_state": "現在、契約しているIaaS/PaaS事業者のデータセンター所在地に依存。国内の複数リージョンを利用。", "status": "対応中", "priority": "中", "department": "情報システム部", "target_date": "2025-12-31", "completion_date": "", "certification": "", "notes": "データ保管場所を明記したドキュメントを作成中。" },
        { "id": "RM-0006", "question": "サービスで取り扱う情報(データ)の著作権は、サービス提供社に帰属しないようになっているか？", "current_state": "利用規約に明記済みだが、より平易な表現での説明資料がない。", "status": "未対応", "priority": "低", "department": "法務部", "target_date": "2026-04-30", "completion_date": "", "certification": "", "notes": "FAQページなどに著作権の帰属に関する項目を追加する。" },
        { "id": "RM-0007", "question": "入力した個人情報などのデータが別の第三者に利用されることはないか", "current_state": "プライバシーポリシーに記載済みだが、具体的な利用目的の範囲が分かりにくいとの指摘がある。", "status": "未対応", "priority": "中", "department": "法務部", "target_date": "2026-02-28", "completion_date": "", "certification": "", "notes": "プライバシーポリシーの改訂を検討。" },
        { "id": "RM-0008", "question": "CRYPTREC暗号リストに記載されている暗号を使用して通信・データ保管が暗号化されているか。", "current_state": "通信はTLS 1.2以上で対応済み。保管データの暗号化アルゴリズムについて、CRYPTRECリストとの対応を明記した資料がない。", "status": "未対応", "priority": "中", "department": "開発部", "target_date": "2026-03-31", "completion_date": "", "certification": "", "notes": "利用している暗号化技術とCRYPTRECリストの対照表を作成する。" }
    ];

    document.addEventListener('DOMContentLoaded', initializeApp);

    function initializeApp() {
        setupTabs();
        populateSearchTab();
    }

    function setupTabs() {
        const tabs = document.querySelectorAll('.tab-btn');
        tabs.forEach(tab => {
            tab.addEventListener('click', () => {
                tabs.forEach(item => item.classList.remove('active'));
                tab.classList.add('active');
                const targetId = tab.getAttribute('data-tab');
                
                document.querySelectorAll('.tab-content').forEach(c => c.classList.add('hidden'));
                document.getElementById(`${targetId}-content`).classList.remove('hidden');

                const populateFunctions = {
                    search: populateSearchTab,
                    knowledge: populateKnowledgeBase,
                    roadmap: populateRoadmapTab,
                    master: populateCategoryMaster,
                    manual: populateManual
                };
                // Check if the function exists before calling it
                if (populateFunctions[targetId]) {
                    populateFunctions[targetId]();
                }
            });
        });
    }

    function populateSearchTab() {
        const container = document.getElementById('search-content');
        if (container.innerHTML) return;
        container.innerHTML = `
            <div class="search-box">
                <label for="search-input" class="block text-sm font-medium text-gray-700 mb-2">↓ここにクライアントからの質問を貼り付けて検索</label>
                <input type="text" id="search-input" class="w-full p-2 border border-gray-300 rounded-md shadow-sm" placeholder="例：ISMS 認証">
            </div>
            <h2 class="text-xl font-semibold text-gray-800 mt-6 mb-4">検索結果</h2>
            <div class="table-container">
                <table class="min-w-full divide-y divide-gray-200">
                    <thead class="bg-gray-50"><tr><th>ID</th><th>カテゴリ</th><th>質問</th><th>標準回答</th><th>補足情報</th></tr></thead>
                    <tbody id="search-results"></tbody>
                </table>
            </div>`;
        document.getElementById('search-input').addEventListener('input', performSearch);
        performSearch();
    }

    function populateKnowledgeBase() {
        const container = document.getElementById('knowledge-content');
        container.innerHTML = `
            <h2 class="text-xl font-semibold text-gray-800 mb-4">ナレッジベース一覧</h2>
            <div class="table-container">
                <table class="min-w-full divide-y divide-gray-200">
                    <thead class="bg-gray-50"><tr><th>ID</th><th>大カテゴリ</th><th>中カテゴリ</th><th>質問</th><th>キーワード</th><th>標準回答</th><th>補足情報</th><th>担当部署</th><th>最終更新日</th></tr></thead>
                    <tbody>${knowledgeBaseData.map(item => `
                        <tr class="hover:bg-gray-50">
                            <td>${item.id||''}</td><td>${item.daiCategory||''}</td><td>${item.chuCategory||''}</td><td>${item.question||''}</td><td>${item.keywords||''}</td><td>${item.answer||''}</td><td>${item.supplement||''}</td><td>${item.department||''}</td><td>${item.updated||''}</td>
                        </tr>`).join('')}
                    </tbody>
                </table>
            </div>`;
    }

    function populateRoadmapTab() {
        const container = document.getElementById('roadmap-content');
        container.innerHTML = `
            <h2 class="text-xl font-semibold text-gray-800 mb-4">未対応項目ロードマップ</h2>
            <p class="text-sm text-gray-600 mb-4">現在未対応となっている項目の一覧です。</p>
            <div class="table-container">
                <table id="roadmap-table" class="min-w-full divide-y divide-gray-200">
                    <thead class="bg-gray-50">
                        <tr>
                            <th>ID</th><th>項目名</th><th>現状</th><th>ステータス</th><th>優先度</th><th>担当部署</th><th>対応完了予定日</th><th>対応完了日</th><th>必要な外部認証</th><th>備考</th>
                        </tr>
                    </thead>
                    <tbody id="roadmap-table-body">${roadmapData.map(item => `
                        <tr class="hover:bg-gray-50">
                            <td>${item.id}</td><td>${item.question}</td><td>${item.current_state}</td><td>${item.status}</td>
                            <td>${item.priority}</td><td>${item.department}</td><td>${item.target_date}</td><td>${item.completion_date}</td>
                            <td>${item.certification}</td><td>${item.notes}</td>
                        </tr>`).join('')}
                    </tbody>
                </table>
            </div>`;
    }

    function populateCategoryMaster() {
        const container = document.getElementById('master-content');
        const daiCategories = [...new Set(knowledgeBaseData.map(item => item.daiCategory).filter(Boolean))];
        const chuCategories = [...new Set(knowledgeBaseData.map(item => item.chuCategory).filter(Boolean))];
        container.innerHTML = `
            <h2 class="text-xl font-semibold text-gray-800 mb-4">カテゴリマスタ</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div><h3 class="font-semibold text-lg mb-2 border-b pb-2">大カテゴリ</h3><ul class="list-disc list-inside">${daiCategories.map(c => `<li>${c}</li>`).join('')}</ul></div>
                <div><h3 class="font-semibold text-lg mb-2 border-b pb-2">中カテゴリ</h3><ul class="list-disc list-inside">${chuCategories.map(c => `<li>${c}</li>`).join('')}</ul></div>
            </div>`;
    }

    function populateManual() {
        const container = document.getElementById('manual-content');
        if (container.innerHTML) return;
        container.innerHTML = `
            <h2 class="text-xl font-semibold text-gray-800 mb-4">使い方・運用フロー</h2>
            <div class="space-y-6 text-gray-700 prose max-w-none">
                <p>このツールは、セキュリティチェックシートへの回答業務を効率化するための、社内向けナレッジベースです。</p>
                <h3>ナレッジの検索と利用</h3>
                <ol>
                    <li><strong>「① 検索＆回答」タブ</strong> を開きます。</li>
                    <li>上部の検索ボックスに、顧客からの質問や関連キーワードを入力し、過去の回答事例を検索します。</li>
                </ol>
                <h3>ナレッジとロードマップの更新</h3>
                <ol>
                    <li>新しいチェックシートのファイルを受け取ったら、<strong>このチャット画面にファイルをアップロードしてください。</strong></li>
                    <li>AI（私）がファイル内容を分析し、ナレッジベースとロードマップを更新した新しいツールを提供します。</li>
                </ol>
            </div>`;
    }

    function performSearch() {
        const query = document.getElementById('search-input').value.toLowerCase().trim();
        const container = document.getElementById('search-results');
        const results = query === '' ? knowledgeBaseData : knowledgeBaseData.filter(item => 
            `${item.question || ''} ${item.keywords || ''}`.toLowerCase().includes(query)
        );
        
        if (results.length === 0) {
            container.innerHTML = `<tr><td colspan="5" class="text-center py-10">該当する回答が見つかりません。</td></tr>`;
        } else {
            container.innerHTML = results.map(item => `
                <tr><td>${item.id||''}</td><td>${(item.daiCategory||'') + ' > ' + (item.chuCategory||'')}</td><td>${item.question||''}</td><td>${item.answer||''}</td><td>${item.supplement||''}</td></tr>
            `).join('');
        }
    }
</script>
</body>
</html>
